import{r as l,j as p,c as oe}from"./index-B_MG8wrx.js";function re(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var N={exports:{}},H,X;function ne(){if(X)return H;X=1;var u="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return H=u,H}var _,B;function se(){if(B)return _;B=1;var u=ne();function m(){}function a(){}return a.resetWarningCache=m,_=function(){function n(E,x,y,d,T,C){if(C!==u){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}n.isRequired=n;function f(){return n}var S={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:f,element:n,elementType:n,instanceOf:f,node:n,objectOf:f,oneOf:f,oneOfType:f,shape:f,exact:f,checkPropTypes:a,resetWarningCache:m};return S.PropTypes=S,S},_}var U;function ie(){return U||(U=1,N.exports=se()()),N.exports}var ae=ie();const M=re(ae),G=l.forwardRef(({children:u,onSelectionChange:m,onSelectionComplete:a,minSelectionSize:n=10,handleSize:f=8,className:S="",style:E={},enabled:x=!0},y)=>{const d=l.useRef(null),[T,C]=l.useState(!1),[w,z]=l.useState(!1),[R,j]=l.useState("none"),[$,V]=l.useState({x:0,y:0}),[r,k]=l.useState({x:0,y:0,width:0,height:0}),[O,J]=l.useState({x:0,y:0}),[I,D]=l.useState(null),[b,K]=l.useState({width:0,height:0});l.useEffect(()=>{if(d.current){const t=()=>{K({width:d.current.offsetWidth,height:d.current.offsetHeight})};t();const s=new ResizeObserver(t);return s.observe(d.current),()=>{d.current&&s.unobserve(d.current)}}},[]);const W=l.useCallback((t,s)=>{let{x:e,y:o,width:i,height:c}=r,h,g;switch(I){case"topleft":h=Math.min(t,e+i-n),g=Math.min(s,o+c-n),i=e+i-h,c=o+c-g,e=h,o=g;break;case"topright":g=Math.min(s,o+c-n),i=Math.max(n,t-e),c=o+c-g,o=g;break;case"bottomleft":h=Math.min(t,e+i-n),i=e+i-h,c=Math.max(n,s-o),e=h;break;case"bottomright":i=Math.max(n,t-e),c=Math.max(n,s-o);break;case"top":g=Math.min(s,o+c-n),c=o+c-g,o=g;break;case"bottom":c=Math.max(n,s-o);break;case"left":h=Math.min(t,e+i-n),i=e+i-h,e=h;break;case"right":i=Math.max(n,t-e);break}k({x:Math.max(0,e),y:Math.max(0,o),width:Math.min(i,b.width-e),height:Math.min(c,b.height-o)})},[r,I,n,b]),v=(t,s,e,o,i,c)=>t>=e&&t<=e+i&&s>=o&&s<=o+c,q=l.useCallback((t,s)=>{if(!w)return null;const e=f+4,{x:o,y:i,width:c,height:h}=r;return v(t,s,o-e/2,i-e/2,e,e)?"topleft":v(t,s,o+c-e/2,i-e/2,e,e)?"topright":v(t,s,o-e/2,i+h-e/2,e,e)?"bottomleft":v(t,s,o+c-e/2,i+h-e/2,e,e)?"bottomright":v(t,s,o+c/2-e/2,i-e/2,e,e)?"top":v(t,s,o+c/2-e/2,i+h-e/2,e,e)?"bottom":v(t,s,o-e/2,i+h/2-e/2,e,e)?"left":v(t,s,o+c-e/2,i+h/2-e/2,e,e)?"right":null},[w,r,f]),Q=l.useCallback(t=>{if(!x||!d.current)return;const s=d.current.getBoundingClientRect(),e=t.clientX-s.left,o=t.clientY-s.top;if(w){const i=q(e,o);if(i){C(!0),j("resize"),D(i);return}if(e>=r.x&&e<=r.x+r.width&&o>=r.y&&o<=r.y+r.height){C(!0),j("move"),J({x:e-r.x,y:o-r.y});return}}C(!0),j("select"),V({x:e,y:o}),k({x:e,y:o,width:0,height:0})},[x,w,r,q]),A=l.useCallback(t=>{if(!T||!d.current)return;const s=d.current.getBoundingClientRect(),e=Math.max(0,Math.min(t.clientX-s.left,b.width)),o=Math.max(0,Math.min(t.clientY-s.top,b.height));if(R==="select")k({x:Math.min($.x,e),y:Math.min($.y,o),width:Math.abs(e-$.x),height:Math.abs(o-$.y)});else if(R==="move"){const i=Math.max(0,Math.min(e-O.x,b.width-r.width)),c=Math.max(0,Math.min(o-O.y,b.height-r.height));k(h=>({...h,x:i,y:c}))}else R==="resize"&&W(e,o);m&&m(r)},[T,R,$,r,O,W,b,m]),P=l.useCallback(()=>{z(!1),k({x:0,y:0,width:0,height:0})},[]),F=l.useCallback(()=>{T&&(R==="select"&&(r.width>n&&r.height>n?z(!0):P()),C(!1),j("none"),D(null),a&&a(r))},[T,R,r,n,a,P]),Z=t=>{switch(t){case"topleft":case"bottomright":return"nwse-resize";case"topright":case"bottomleft":return"nesw-resize";case"top":case"bottom":return"ns-resize";case"left":case"right":return"ew-resize";default:return"move"}};l.useEffect(()=>{const t=e=>A(e),s=()=>F();return document.addEventListener("mousemove",t),document.addEventListener("mouseup",s),()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",s)}},[A,F]);const ee=l.useCallback(()=>{if(!w||!d.current)return null;const t=d.current.getBoundingClientRect(),s=window.pageXOffset||document.documentElement.scrollLeft,e=window.pageYOffset||document.documentElement.scrollTop;return{x:t.left+r.x+s,y:t.top+r.y+e,width:r.width,height:r.height,relative:{...r}}},[w,r]);l.useImperativeHandle(y,()=>({getCoordinates:ee,resetSelection:P,hasActiveSelection:()=>w,getSelectionRect:()=>({...r})}));const te=()=>{if(!w||r.width===0||r.height===0)return"none";const{x:t,y:s,width:e,height:o}=r,i=b.width,c=b.height,h=t/i*100,g=s/c*100,L=(t+e)/i*100,Y=(s+o)/c*100;return`polygon(0% 0%, 0% 100%, 100% 100%, 100% 0%, 0% 0%, ${h}% ${g}%, ${L}% ${g}%, ${L}% ${Y}%, ${h}% ${Y}%, ${h}% ${g}%)`};return p.jsxs("div",{ref:d,className:`element-selector ${S}`,style:{position:"relative",...E},onMouseDown:x?Q:void 0,children:[u,x&&p.jsx("div",{className:"selection-overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.3)",clipPath:te(),pointerEvents:"none",zIndex:1e3}}),x&&T&&R==="select"&&p.jsx("div",{className:"selection-in-progress",style:{position:"absolute",left:`${r.x}px`,top:`${r.y}px`,width:`${r.width}px`,height:`${r.height}px`,border:"2px dashed rgba(0, 255, 0, 0.8)",backgroundColor:"rgba(0, 255, 0, 0.1)",boxSizing:"border-box",pointerEvents:"none",zIndex:1001}}),x&&w&&p.jsx("div",{className:"selection-rect",style:{position:"absolute",left:`${r.x}px`,top:`${r.y}px`,width:`${r.width}px`,height:`${r.height}px`,border:"2px solid rgba(0, 255, 0, 0.8)",backgroundColor:"rgba(0, 255, 0, 0.1)",boxSizing:"border-box",pointerEvents:"none",zIndex:1001},children:["topleft","top","topright","right","bottomright","bottom","bottomleft","left"].map(t=>p.jsx("div",{className:`resize-handle ${t}`,style:{position:"absolute",width:`${f}px`,height:`${f}px`,backgroundColor:"white",border:"2px solid rgba(0, 100, 0, 0.8)",borderRadius:"50%",pointerEvents:"all",cursor:Z(t),...ce(t,f),zIndex:1002},onMouseDown:s=>{s.stopPropagation(),C(!0),j("resize"),D(t)}},t))})]})});function ce(u,m){const a=m/2;switch(u){case"topleft":return{top:-a,left:-a};case"top":return{top:-a,left:`calc(50% - ${a}px)`};case"topright":return{top:-a,right:-a};case"right":return{top:`calc(50% - ${a}px)`,right:-a};case"bottomright":return{bottom:-a,right:-a};case"bottom":return{bottom:-a,left:`calc(50% - ${a}px)`};case"bottomleft":return{bottom:-a,left:-a};case"left":return{top:`calc(50% - ${a}px)`,left:-a};default:return{}}}G.propTypes={children:M.node.isRequired,onSelectionChange:M.func,onSelectionComplete:M.func,minSelectionSize:M.number,handleSize:M.number,className:M.string,style:M.object,enabled:M.bool};function le(){const u=l.useRef(null),[m,a]=l.useState(!1),[n,f]=l.useState(null),S=y=>{console.log("Selection changing:",y)},E=y=>{console.log("Selection completed:",y),a(!0)},x=()=>{var d;if(!((d=u.current)!=null&&d.hasActiveSelection())){console.log("No active selection");return}const y=u.current.getCoordinates();console.log("Selection coordinates:",y),f(y),setTimeout(()=>{u.current.resetSelection(),a(!1),f(null)},2e3)};return p.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[p.jsx(G,{ref:u,className:"fixed z-[9000] inset-0 w-[100svw] h-[100svh]",onSelectionChange:S,onSelectionComplete:E,minSelectionSize:5,children:p.jsx("div",{className:"w-full h-full"})}),p.jsxs("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-[10000] flex flex-col items-center gap-4",children:[p.jsx("button",{onClick:x,disabled:!m,className:`border-0 p-4 rounded-lg cursor-pointer grid place-items-center transition-all duration-300 ${m?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"}`,children:m?"Show Coordinates":"Make a selection first"}),n&&p.jsxs("div",{className:"bg-white text-black p-4 rounded-lg shadow-lg",children:[p.jsxs("p",{children:["X: ",Math.round(n.x)]}),p.jsxs("p",{children:["Y: ",Math.round(n.y)]}),p.jsxs("p",{children:["Width: ",Math.round(n.width)]}),p.jsxs("p",{children:["Height: ",Math.round(n.height)]})]})]})]})}function he(){window.showCoordinates=()=>window.aiDisplaySelector?window.aiDisplaySelector.showCoordinates():(console.error("aiDisplaySelector not initialized yet"),null),window.resetSelection=()=>{window.aiDisplaySelector?window.aiDisplaySelector.resetSelection():console.error("aiDisplaySelector not initialized yet")},window.hasActiveSelection=()=>window.aiDisplaySelector?window.aiDisplaySelector.hasActiveSelection():(console.error("aiDisplaySelector not initialized yet"),!1),window.getCoordinates=()=>window.aiDisplaySelector?window.aiDisplaySelector.getCoordinates():(console.error("aiDisplaySelector not initialized yet"),null),console.log("Global selection functions are now available on the window object")}function ue(){return l.useEffect(()=>{he()},[]),p.jsx(l.StrictMode,{children:p.jsx(le,{})})}oe.createRoot(document.getElementById("root")).render(p.jsx(ue,{}));
